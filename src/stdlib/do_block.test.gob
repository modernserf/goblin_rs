import [_Assert_ _Log_] := "core"

let obj := [
  on {send: do f}
    f{x}
]

let result := [{}
  obj{send: 
    on {x} 1
  }
]{}
Assert{: result = 1}

let result := [{}
  obj{send: [
    on {x} 
      return 1
  ]}
  2
]{}
Assert{: result = 2}

let result := [{}
  obj{send: 
    on {x}
      return 1
  }
  2
]{}
Assert{: result = 1}

Assert{panics: [{}
  let obj := [
    on {send: f}
      f{x}
  ]
  obj{send: 
    on {x} 1
  }
]}
